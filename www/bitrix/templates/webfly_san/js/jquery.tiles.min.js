!function(e,t){function i(t,i){this.opts=e.extend({},s,i),this.klass="tiles-"+this.opts.effect,this.klassNormal=this.klass+"-normal",this.klassAnim=this.klass+"-anim",this.n_tiles=this.opts.x*this.opts.y,this.$container=e(t),this.$images=this.$container.find("img"),this.imgWidth=this.$container.width(),this.imgHeight=this.$container.height(),this.timeouts=[],this.slideshow=null,this.isAnimating=null,this.$navLinks=null,this.$descriptions=null,this.$timer=null,this.opts.rewind&&(this.opts.fade=!0),this._init()}var s={x:4,y:4,slider:!1,effect:"default",fade:!1,random:!1,reverse:!1,backReverse:!1,limit:!1,rewind:!1,auto:!1,loop:!1,slideSpeed:3500,tileSpeed:800,cssSpeed:300,nav:!0,bullets:!0,navWrap:null,thumbs:!0,thumbSize:25,timer:!0,beforeChange:e.noop,afterChange:e.noop,onSlideshowEnd:e.noop},n={shuffle:function(e){for(var t,i,s=e.length;s;t=Math.floor(Math.random()*s),i=e[--s],e[s]=e[t],e[t]=i);return e},range:function(e,t,i){for(var s=[],r=e;t>=r;r++)s.push(r);return i?n.shuffle(s):s}};i.prototype={_init:function(){var i=this,s=i.opts;return i.$images.length?(i.$container.addClass("tiles-slider-wrap tiles-slider-"+s.effect+" tiles-slider-s"+s.cssSpeed),i.$images.each(function(){i._generateTiles(e(this))}),i.$wraps=i.$container.find(".tiles-wrap").detach(),i.$wraps.first().addClass("tiles-wrap-current").appendTo(i.$container),s.nav&&(i._addNav(),i.$navLinks=i.$container.find(".tiles-nav-item")),s.timer&&(i._addTimer(),i.$timer=i.$container.find(".tiles-timer")),i._setupDescriptions(),i.$descriptions=i.$container.find(".tiles-description"),i._showOrHideDescription(),e("body").addClass("tiles-preload"),e(t).load(function(){e("body").removeClass("tiles-preload")}),void(s.auto&&i.start())):!1},_addTimer:function(){this.$container.append('<div class="tiles-timer"/>')},_updateTimer:function(){this.opts.timer&&this.$timer.animate({width:"100%"},this.opts.slideSpeed,"linear")},_resetTimer:function(){this.opts.timer&&this.$timer.stop(!0).width(0)},_addNav:function(){for(var t,i,s=this,n=s.opts,r=e(n.navWrap||"<div/>").addClass("tiles-nav"),a=[],o=e('<a href="#" class="tiles-next">Next &raquo;</a>'),l=e('<a href="#" class="tiles-prev">&laquo; Prev</a>'),d=s.imgHeight*n.thumbSize/100,h=s.imgWidth*n.thumbSize/100,p=1;p<s.$wraps.length+1;p++)i='<span><img src="'+s.$images.eq(p-1).attr("src")+'"/></span>',a.push('<a href="#" class="tiles-nav-item '+(n.bullets?"tiles-bullet":"tiles-pagination")+'">'+(n.bullets?"":p)+(n.thumbs?i:"")+"</a>");t=e(a.join("")),t.click(function(){var i=e(this),n=t.index(i);s._navigate(n,e.noop)}),t.first().addClass("tiles-nav-active"),o.click(function(){s.next()}),l.click(function(){s.prev()}),t.add(o).add(l).click(function(e){e.preventDefault()}),n.navWrap?r.append(t):(s.$container.append(r.append(t)),r.css("margin-left","-"+r.outerWidth()/2+"px")),s.$container.append(l,o),t.find("img").height(d).width(h),t.find("span").each(function(){var t=e(this);t.css({top:-t.outerHeight()-r.outerHeight(),left:-(t.outerWidth()-t.parent().outerWidth())/2})})},_updateNav:function(){this.opts.nav&&this.$navLinks.removeClass("tiles-nav-active").eq(this._getCurrentIdx()).addClass("tiles-nav-active")},_setupDescriptions:function(){this.$images.each(function(){e(this).next("p").length||e(this).after("<p/>")}),this.$container.find("p").each(function(){e(this).wrapAll('<div class="tiles-description '+(e(this).is(":empty")?"tiles-description-empty":"")+'"/>')})},_showOrHideDescription:function(e){this.$descriptions.removeClass("tiles-description-active").eq(this._getCurrentIdx()).toggleClass("tiles-description-active",e)},_generateTiles:function(t){for(var i,s=this,n=s.opts,r=[],a=0;a<s.n_tiles;a++)r.push('<div class="tiles-tile '+s.klassNormal+'"/>');i=e(r.join("")),i.addClass("tiles-x"+n.x+" tiles-y"+n.y).filter(":odd").addClass("tiles-odd").end().filter(":even").addClass("tiles-even"),i.css({width:s.imgWidth/n.x,height:s.imgHeight/n.y,backgroundImage:"url("+t.attr("src")+")"}),e('<div class="tiles-wrap"/>').append(i).insertAfter(t.hide()),i.each(function(){var t=e(this),i=t.position();t.css("backgroundPosition",-i.left+"px "+-i.top+"px")})},_animateTiles:function(t,i){i=i||e.noop;var s=this,r=s.opts,a=n.range(0,s.n_tiles,r.random),o=Math.floor(r.tileSpeed/s.n_tiles),l=a.length/(100/r.limit),d=s.n_tiles>1?r.tileSpeed+r.cssSpeed:r.cssSpeed,h=t.find(".tiles-tile");s.isAnimating=!0,r.reverse&&(a=a.reverse()),r.limit&&(r.reverse?a.splice(0,l):a.splice(l,a.length)),e.each(a,function(e,t){var i=h.eq(t),n=e*o;setTimeout(function(){i.addClass(s.klassAnim)},n),r.rewind&&(n+=r.cssSpeed/(100/r.rewind),setTimeout(function(){i.removeClass(s.klassAnim)},n))}),setTimeout(function(){s.isAnimating=!1,i()},d)},_resetTiles:function(e){e.find(".tiles-tile").removeClass(this.klassAnim)},_getCurrentWrap:function(){return this.$wraps.filter(".tiles-wrap-current")},_getCurrentIdx:function(){return this.$wraps.index(this._getCurrentWrap())},_navigate:function(e,t){var i=this,s=i.opts,n=i._getCurrentWrap(),r=i.$wraps.eq(e),a=i._getCurrentIdx();return e===a||i.isAnimating?!1:(i.$container.find(".tiles-wrap").removeClass("tiles-wrap-current"),r.addClass("tiles-wrap-current").prependTo(i.$container),s.fade&&r.fadeOut(1).fadeIn(s.tileSpeed),s.rewind&&n.fadeIn(1).delay(s.tileSpeed/2).fadeOut(s.tileSpeed),s.backReverse&&(s.reverse=a>e),i._animateTiles(n,function(){n.remove(),i._resetTiles(n),i._showOrHideDescription(!0),i.slideshow&&i.stop().start(),t&&t(),s.afterChange()}),s.beforeChange(),i._updateNav(),i._resetTimer(),i._showOrHideDescription(!1),this)},prev:function(t){var i=this,s=i._getCurrentWrap(),n=s.is(i.$wraps.first()),r=n?i.$wraps.length-1:i._getCurrentIdx()-1;return this._navigate(r,t||e.noop)},next:function(t){var i=this,s=i._getCurrentWrap(),n=s.is(i.$wraps.last()),r=n?0:i._getCurrentIdx()+1;return this._navigate(r,t||e.noop)},start:function(){var e=this,t=e.opts,i=t.slideSpeed+t.cssSpeed,s=i*(e.$wraps.length-e._getCurrentIdx());return e.n_tiles>1&&(s+=t.tileSpeed),this.slideshow=!0,e.timeouts.push(setTimeout(function(){e.next()},t.slideSpeed)),t.loop||e.timeouts.push(setTimeout(function(){e.stop(),t.onSlideshowEnd()},s)),this._updateTimer(),this},stop:function(){return e.each(this.timeouts,function(e,t){clearTimeout(t)}),this.slideshow=!1,this._resetTimer(),this}},e.fn.tilesSlider=function(t){var s=Array.prototype.slice.call(arguments,1);return this.each(function(){if("string"==typeof t){var n=e.data(this,"tiles-slider");n[t].apply(n,s)}else e.data(this,"tiles-slider")||e.data(this,"tiles-slider",new i(this,t))})}}(jQuery,window);